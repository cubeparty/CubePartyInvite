<!doctype html>
<html>
	<head>
		<title>CubeParty Invite</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
		
		<!-- libs -->
		<script src="lib/three.min.js"></script>
		<script src="lib/Detector.js"></script>
		<script src='lib/threex.windowresize.js'></script>
		<script src='lib/threex.atmospherematerial.js'></script>
		<script src='lib/threex.atmospherematerialdatgui.js'></script>
		<script src='lib/threex.dilategeometry.js'></script>
		<script src='lib/threex.geometricglowmesh.js'></script>
		<script src='lib/soundmanager2-nodebug-jsmin.js'></script>
		<script src='lib/Stats.js'></script>
		<script src='lib/shaders/CopyShader.js'></script>
		<script src='lib//shaders/DotScreenShader.js'></script>
		<script src='lib/shaders/RGBShiftShader.js'></script>
		<script src='lib/postprocessing/EffectComposer.js'></script>
		<script src='lib/postprocessing/RenderPass.js'></script>
		<script src='lib/postprocessing/MaskPass.js'></script>
		<script src='lib/postprocessing/ShaderPass.js'></script>
		<script src='lib/greensock-js/TimelineLite.min.js'></script>
		<script src='lib/greensock-js/TweenLite.min.js'></script>
		<!-- src -->
		<script src="src/cubeparty.js"></script>
		<script src="src/loadinganim.js"></script>
		<script src="src/knot.js"></script>
		<script src="src/cube.js"></script>
		<script src="src/still.js"></script>
		<script src="src/fill.js"></script>
		<script src="src/pill.js"></script>
<!------ shader ------>
<script id="vertexShader" type="x-shader/x-vertex">
uniform float amplitude;
attribute float displacement;
varying vec3 vNormal;
varying vec2 vUv;
void main() {
	vUv = uv;
	vNormal = normal;

	// multiply our displacement by
	// the amplitude. The amp will
	// get animated so we'll have
	// animated displacement
	vec3 newPosition = position + normal * vec3(displacement * amplitude);
	gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);
}
</script>
<script id="fragmentShader" type="x-shader/x-fragment">
precision highp float;
varying vec2 vUv;
uniform float color;
void main(void) {
    gl_FragColor = vec4(dot(vUv.x, vUv.y) * color);
}
</script>
<script id="fillFragmentShader" type="x-shader/x-fragment">
precision highp float;
varying vec2 vUv;
uniform float color;
void main(void) {
    gl_FragColor = vec4(dot(vUv.x, vUv.y) * color);
}
</script>
<script id="fillVertexShader" type="x-shader/x-vertex">
uniform float amplitude;
attribute float displacement;
varying vec3 vNormal;
varying vec2 vUv;
void main() {
	vUv = uv;
	vNormal = normal;

	// multiply our displacement by
	// the amplitude. The amp will
	// get animated so we'll have
	// animated displacement
	vec3 newPosition = position + normal * vec3(displacement * amplitude);
	gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);
}
</script>
<script id="pillFragmentShader" type="x-shader/x-fragment">
precision highp float;
varying vec2 vUv;
uniform float color;
uniform float time;
void main() {
	vec2 position = -1.0 + 2.0 * vUv;

	float red = abs(sin(position.x * position.y + time * 2.0 / 4.0));
	float green = abs(sin(position.x * position.y + time * 2.0 / 3.0));
	float blue = abs(sin(position.x * position.y + time * 2.0 / 2.0 ));
	gl_FragColor = vec4(red, green, blue, 1.0) * color;
}
</script>
<script id="pillVertexShader" type="x-shader/x-vertex">
uniform float amplitude;
attribute float displacement;
varying vec3 vNormal;
varying vec2 vUv;
void main() {
	vUv = uv;
	vNormal = normal;

	// multiply our displacement by
	// the amplitude. The amp will
	// get animated so we'll have
	// animated displacement
	vec3 newPosition = position + normal * vec3(displacement * amplitude);
	gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);
}
</script>
<!------ css ------>
		<style type="text/css">
		html {
			cursor: none;
		}
		body {
			overflow	: hidden;
			padding		: 0;
			margin		: 0;

			color		: #000;
			background-color: #000;
			font-family	: font-family: Monospace;
			font-size	: 100%;
		}
		#info .top {
			position	: absolute;
			top		: 0px;
			width		: 100%;
			padding		: 5px;
			text-align	: center;
		}
		#info a {
			color		: #66F;
			text-decoration	: none;
		}
		#info a:hover {
			text-decoration	: underline;
		}
		#info .bottom {
			position	: absolute;
			bottom		: 0px;
			right		: 5px;
			padding		: 5px;
		}
		#info h2 {
			color		: white
		}
		</style>
	</head>
<body>
    <div id="container"></div>
	<script type="text/javascript">
console.log(`string text line 1
string text line 2`);
		var disableSound = false;
		createCubeParty(function(createActor, audio) {
			// Setup audio url. Could be also actor itself
			
			// Music by ***Jusa***
			audio.url = 'res/jusa_01.mp3';
			//
			audio.volume = disableSound ? 0 : 100;
			// Create actors. Second argument, the Label is mandatory to reference the actor in stage setup. Dont' use reserved words shown in then(..) arguments please.
			// Knock knock.. who's there. Actor. Actor who? Actor who's going to twist your audio-visual nerves. When? Wait i get out of sauna first.
			createActor(knot, 'blueknot', [0x00fafa]),
			createActor(knot, 'redknot', [0xffaffa]);
			createActor(cube, 'cube', [0xffaffa]);
			createActor(still, 'thanks', ['path']);
			createActor(fill, 'fill', ['path']);
			createActor(pill, 'flower', ['path']);
			// Actors are created and audio loaded. Next step is to setup stage.
			}).then(function(ctx) { // scene, ctl, "<actor_labels>+", controls,
				// Add actor's visuals to Threejs scene tree. Check docs at http://threejs.org/docs/
				ctx.scene.add(ctx.blueknot.rootObject);
				ctx.scene.add(ctx.redknot.rootObject);
				ctx.scene.add(ctx.thanks.rootObject);
				ctx.scene.add(ctx.fill.rootObject);
				ctx.scene.add(ctx.flower.rootObject);
				ctx.scene.add(ctx.cube.rootObject);
				// Sequnce the actors in control GSAP TimelineLite (ctl). Check docs at http://greensock.com/timelinelite
		
				ctx.ctl.call(function() {;
					ctx.fill.timeline.play();
				}, null, null, "0.0");
					
				ctx.ctl.call(function() {
					ctx.redknot.timeline.play();
					}, null, null, "3.0");

				ctx.ctl.call(function() { ctx.fill.timeline.stop();
				}, null, null, "7.0");
				
				ctx.ctl.call(function() { ctx.fill.timeline.play();
				}, null, null, "9.0");

					
				ctx.ctl.call(function() { ctx.postprocessing.enable = true; }, null, null, "14");
				
				ctx.ctl.call(function() {
					ctx.postprocessing.enable = false;
					ctx.thanks.timeline.play();
					}, null, null, "30");

				ctx.ctl.call(function() { ctx.postprocessing.enable = true; }, null, null, "32");
/*				ctx.ctl.call(function() {ctx.fill.timeline.play();
				}, null, null, "11.0");

				ctx.ctl.call(function() { ctx.fill.timeline.stop(); }, null, null, "20");
				
				ctx.ctl.call(function() { ctx.postprocessing.enable = true; }, null, null, "20");

				ctx.ctl.call(function() {
					ctx.postprocessing.enable = false;
					ctx.thanks.timeline.play();
					}, null, null, "30");

				ctx.ctl.call(function() { ctx.postprocessing.enable = true; }, null, null, "50");

				ctx.ctl.call(function() { ctx.postprocessing.enable = false; }, null, null, "45");

				ctx.ctl.call(function() {;
					ctx.postprocessing.enable = false;
					ctx.blueknot.timeline.play();
					}, null, null, "50");
*/
				var flower_start = 50;
				ctx.ctl.call(function() {ctx.postprocessing.enable = false;
				}, null, null, flower_start);
				ctx.ctl.call(function() { ctx.flower.timeline.play();
				}, null, null, flower_start);
				ctx.ctl.call(function() {ctx.postprocessing.enable = true;
				}, null, null, flower_start + 15.0);
				ctx.ctl.call(function() {ctx.postprocessing.enable = true;
				}, null, null, flower_start + 25.0);

				ctx.ctl.call(function() { ctx.fill.timeline.play(0); }, null, null, flower_start + 40);

				// Explicit stopShow command to stop music and control timeline.
				ctx.ctl.call(function() {ctx.controls.stopShow();}, null, null, 0 );//'+=' + ctx.blueknot.timeline.endTime());
				// Stage is set, start show.
				ctx.controls.startShow()
		});
	</script>
</body>
</html>
